
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>circuitSolver &#8212; ElectroacPy</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '07-circuitSolver';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="LEM modules" href="08-LEM_backend.html" />
    <link rel="prev" title="Back-end" href="06-back_end.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="01-introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="ElectroacPy - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="ElectroacPy - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="01-introduction.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Loudspeaker System</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="02-loudspeaker_system.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="021-system_and_mesh.html">System overview and meshing</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-lumped_modeler.html">Lumped Element Modeler</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-BEM_modeler.html">Boundary Element Modeler</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-post_processing.html">Post-processing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back-end</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06-back_end.html">Back-end</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">circuitSolver</a></li>
<li class="toctree-l1"><a class="reference internal" href="08-LEM_backend.html">LEM modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="09-BEM_backend.html">BEM module</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="100-ref.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F07-circuitSolver.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/07-circuitSolver.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>circuitSolver</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electric">electric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acoustic">acoustic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coupler-controlled-sources">Coupler / Controlled sources</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blocks">Blocks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">electric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrodynamic">electrodynamic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-example">Application example</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="circuitsolver">
<span id="chapter-circuitsolver"></span><h1>circuitSolver<a class="headerlink" href="#circuitsolver" title="Link to this heading">#</a></h1>
<p>Before diving into the lumped-element wrappers, it is best to present the <strong>circuitSolver</strong> class. It lets the user create electrical networks and uses (a fairly simplified) Modified Nodal Analysis (MNA) to solve nodes potential and sources current in the frequency domain. It is the basis on which electroacPy’s lumped-element classes are built. Using networks through <strong>circuitSolver</strong> allows much more flexibility when describing electro-acoustic networks — as long as you know how to describe your system with lumped-elements.</p>
<p>Networks are initialized by creating a <strong>circuit</strong> object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">circuitSolver.solver</span> <span class="kn">import</span> <span class="n">circuit</span>

<span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># frequency axis</span>
<span class="n">network</span>   <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>      <span class="c1"># circuit object</span>
</pre></div>
</div>
<p>Five methods are then available to the user:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.addComponent()</span></code>, add one or several 2-port elements,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.addBlock()</span></code>, add one or several multi-port elements,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.run()</span></code>, solve the circuit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.getPotential()</span></code>, extract potential at given node,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.getFlow()</span></code>, extract current of given source.</p></li>
</ul>
<p>For those interested in MNA, <a class="reference external" href="https://qucs.sourceforge.net/tech/node14.html">QUCS</a> documentation does a really good job explaining its functioning.</p>
<section id="components">
<h2>Components<a class="headerlink" href="#components" title="Link to this heading">#</a></h2>
<section id="electric">
<h3>electric<a class="headerlink" href="#electric" title="Link to this heading">#</a></h3>
<p>The five basic electrical components are given in <a class="reference internal" href="#cir-esource"><span class="std std-numref">Fig. 24</span></a> and <a class="reference internal" href="#cir-ecomponents"><span class="std std-numref">Fig. 25</span></a>. These are defined by their positive and negative nodes (<code class="docutils literal notranslate"><span class="pre">np</span></code> and <code class="docutils literal notranslate"><span class="pre">nm</span></code>, respectively) and associated value in either Volt, Ampere, Ohm, Henry or Farad.</p>
<figure class="align-default" id="cir-esource">
<img alt="_images/electric_sources.svg" src="_images/electric_sources.svg" />
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text"><strong>voltageSource(np, nm, value)</strong> and <strong>currentSource(np, nm, value)</strong>.</span><a class="headerlink" href="#cir-esource" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-ecomponents">
<img alt="_images/electric_components.svg" src="_images/electric_components.svg" />
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">From left to right: <strong>resistance(np, nm, value=Ohm)</strong>, <strong>inductance(np, nm, value=H)</strong>, <strong>capacitance(np, nm, value=F)</strong>.</span><a class="headerlink" href="#cir-ecomponents" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The code below shows how to create a 2nd order lowpass filter. Resulting transfer function is shown in Figure <a class="reference internal" href="#cir-2nd-order-lp"><span class="std std-numref">Fig. 26</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># here, we use the previous network object</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">arange</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span>       <span class="c1"># circuitSolver.components</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">circuit</span>

<span class="n">frequency</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">LP</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>

<span class="c1">#%% Definition of components and cut-off frequency</span>
<span class="c1"># Low pass for a loudspeaker with nominal impedance of 8 Ohm</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">w0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f0</span>
<span class="n">Re</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">L</span>  <span class="o">=</span> <span class="n">Re</span> <span class="o">/</span> <span class="n">w0</span>
<span class="n">C</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">w0</span> <span class="o">/</span> <span class="n">Re</span>

<span class="c1">#%% Create network</span>
<span class="n">Vs</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.83</span><span class="p">)</span>
<span class="n">L1</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">inductance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">L</span><span class="p">)</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">capacitance</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>
<span class="n">R</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Re</span><span class="p">)</span>

<span class="n">LP</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span> <span class="n">L1</span><span class="p">,</span> <span class="n">C1</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
<span class="n">LP</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% Plot data</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">LP</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">LP</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="s2">&quot;dB&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
             <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Transfer function&quot;</span><span class="p">,</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;P_out / P_in [dB]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="cir-2nd-order-lp">
<img alt="_images/2nd_order_lp.svg" src="_images/2nd_order_lp.svg" />
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Transfer function of lowpass filter.</span><a class="headerlink" href="#cir-2nd-order-lp" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="acoustic">
<h3>acoustic<a class="headerlink" href="#acoustic" title="Link to this heading">#</a></h3>
<p>Because the three basic acoustic analogies<a class="footnote-reference brackets" href="#acoustic-analogies" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> can be represented using electric resistance, capacitance and inductance, the acoustic elements discussed here are more complex and use combinations of these smaller components. The pressure source remains similar to the voltage source, this duplicate was made to “simplify” the reading of acoustic circuits.</p>
<figure class="align-default" id="cir-psource">
<img alt="_images/acoustic_source.svg" src="_images/acoustic_source.svg" />
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text"><strong>pressureSource(np, nm, value)</strong>.</span><a class="headerlink" href="#cir-psource" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-cavity">
<img alt="_images/acoustic_cavity.svg" src="_images/acoustic_cavity.svg" />
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text"><strong>cavity(np, nm, Vb, eta=1e-5, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Vb</span></code> the cavity volume (in m<span class="math notranslate nohighlight">\(^3\)</span>), <code class="docutils literal notranslate"><span class="pre">eta</span></code> the loss factor and (<code class="docutils literal notranslate"><span class="pre">rho</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>) the air density and speed of sound. The acoustic compliance is represented by Cb, acoustic leaks are defined by Rl. Generally, nm is connected to ground (node 0).</span><a class="headerlink" href="#cir-cavity" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-port">
<img alt="_images/acoustic_port.svg" src="_images/acoustic_port.svg" />
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text"><strong>port(np, nm, Lp, Sp, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Lp</span></code> the port length and <code class="docutils literal notranslate"><span class="pre">rp</span></code> its radius — both expressed in meters. In that component, Mp and Rp are the acoustic mass and losses, respectively.</span><a class="headerlink" href="#cir-port" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-membrane">
<img alt="_images/acoustic_membrane.svg" src="_images/acoustic_membrane.svg" />
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text"><strong>membrane(np, nm, Cm, Mm, Rm, Sd, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Cm</span></code>, <code class="docutils literal notranslate"><span class="pre">Rm</span></code> the suspension compliance and losses, and <code class="docutils literal notranslate"><span class="pre">Mm</span></code> the moving mass. To convert these mechanical data to the acoustic domain, the radiating surface <code class="docutils literal notranslate"><span class="pre">Sd</span></code> is used. Hence we get the associated components Cma, Mma and Rma.</span><a class="headerlink" href="#cir-membrane" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-radiator">
<img alt="_images/acoustic_radiator.svg" src="_images/acoustic_radiator.svg" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text"><strong>radiator(np, nm, Sd, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Sd</span></code> the radiating surface. This element computes the complex radiating impedance of a circular piston. It should be possible to approximate the radiation of a rectangular surface using this component without to much error. The negative node nm is usually connected to ground. A radiator can be a loudspeaker as well as a port, vibrating plate, etc.</span><a class="headerlink" href="#cir-radiator" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-cline">
<img alt="_images/acoustic_generic.svg" src="_images/acoustic_generic.svg" />
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text"><strong>closed_line(np, nm, Lp, Sp, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Lp</span></code> the line length and <code class="docutils literal notranslate"><span class="pre">Sp</span></code> its cross-sectional. Similarly to <code class="docutils literal notranslate"><span class="pre">.cavity()</span></code>, nm is connected to ground. The closed line element uses transmission line impedance to get the resonances present within a cavity / line.</span><a class="headerlink" href="#cir-cline" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="cir-tline">
<img alt="_images/acoustic_tline.svg" src="_images/acoustic_tline.svg" />
<figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text"><strong>open_line_T(np0, np1, np2, nm, Lp, Sp, rho=1.22, c=343)</strong>. With <code class="docutils literal notranslate"><span class="pre">Lp</span></code> the line length and <code class="docutils literal notranslate"><span class="pre">Sp</span></code> its cross-sectional area. Similarly to <code class="docutils literal notranslate"><span class="pre">cavity</span></code> and <code class="docutils literal notranslate"><span class="pre">closed_line</span></code>, <code class="docutils literal notranslate"><span class="pre">nm</span></code> is connected to ground. This component uses transmission line analogies as well, with Zt and Yt computed from Lp and Sp.</span><a class="headerlink" href="#cir-tline" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The following code demonstrates how to simulate the sound transmission within a duct split by a membrane. <a class="reference internal" href="#membrane-system"><span class="std std-numref">Fig. 34</span></a> represents the simulated system while the resulting transfer function and membrane volume velocity are shown in <a class="reference internal" href="#membrane-h"><span class="std std-numref">Fig. 35</span></a> and <a class="reference internal" href="#membrane-q"><span class="std std-numref">Fig. 36</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span><span class="p">,</span> <span class="n">circuit</span>
<span class="kn">import</span> <span class="nn">generalToolbox</span> <span class="k">as</span> <span class="nn">gtb</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">pi</span>

<span class="c1">#%% Define study parameters</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
<span class="n">Lp1</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">Lp2</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">rp</span>  <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">Sp</span>  <span class="o">=</span> <span class="n">pi</span><span class="o">*</span><span class="n">rp</span><span class="o">**</span><span class="mi">2</span>

<span class="c1">#%% Initialize components</span>
<span class="n">Is</span>       <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">currentSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">line1</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">open_line_T</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Lp1</span><span class="p">,</span> <span class="n">Sp</span><span class="p">)</span>
<span class="n">membrane</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">membrane</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">200e-6</span><span class="p">,</span> <span class="mf">3e-3</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="n">Sp</span><span class="p">)</span>
<span class="n">line2</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">closed_line</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Lp2</span><span class="p">,</span> <span class="n">Sp</span><span class="p">)</span>

<span class="c1">#%% Assemble circuit</span>
<span class="n">cir</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Is</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">membrane</span><span class="p">,</span> <span class="n">line2</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% Extract potentials and currents</span>
<span class="n">p_out</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">p_in</span>  <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">p_m</span>   <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span>     <span class="o">=</span> <span class="n">p_out</span><span class="o">/</span><span class="n">p_in</span>
<span class="n">v_m</span>   <span class="o">=</span> <span class="p">(</span><span class="n">p_m</span> <span class="o">-</span> <span class="n">p_out</span><span class="p">)</span> <span class="o">*</span> <span class="n">membrane</span><span class="o">.</span><span class="n">Gs</span>

<span class="c1">#%% Plot</span>
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="p">(</span><span class="n">p_in</span><span class="p">,</span> <span class="n">p_out</span><span class="p">),</span> <span class="s2">&quot;dB&quot;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;p_in&quot;</span><span class="p">,</span> <span class="s2">&quot;p_out&quot;</span><span class="p">))</span>
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="s2">&quot;dB&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;p_out / p_in&quot;</span><span class="p">)</span>
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">v_m</span><span class="p">,</span> <span class="s2">&quot;dB&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Volume velocity [dB]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="membrane-system">
<img alt="_images/acoustic_transmission.svg" src="_images/acoustic_transmission.svg" />
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">From top to bottom: system under study and lumped element analogy. Notice, from left to right: current source, T line, membrane and closed line.</span><a class="headerlink" href="#membrane-system" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="membrane-h">
<img alt="_images/membrane_H.svg" src="_images/membrane_H.svg" />
<figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">Sound transmission within the duct.</span><a class="headerlink" href="#membrane-h" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="membrane-q">
<img alt="_images/membrane_Q.svg" src="_images/membrane_Q.svg" />
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">Volume velocity at membrane.</span><a class="headerlink" href="#membrane-q" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="coupler-controlled-sources">
<h3>Coupler / Controlled sources<a class="headerlink" href="#coupler-controlled-sources" title="Link to this heading">#</a></h3>
<p>For now, a single controlled source as been implemented. In electro-acoustics, controlled sources are generally used as a way to link two different domains (e.g. electric to mechanic).</p>
<figure class="align-default" id="coupler-ccvs">
<img alt="_images/coupler_ccvs.svg" src="_images/coupler_ccvs.svg" />
<figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Current controlled voltage source. <strong>CCVS(np, nm, np1, nm1, value=R)</strong>. Where <code class="docutils literal notranslate"><span class="pre">R</span></code> is the gain applied on the driven voltage. In the CCVS definition, a zero Volt source is added to read the current of its branch.</span><a class="headerlink" href="#coupler-ccvs" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As an example, we simulate a loudspeaker radiating in free-air (see <a class="reference internal" href="#coupler-spk"><span class="std std-numref">Fig. 38</span></a>). The resulting impedance and membrane velocity are shown in <a class="reference internal" href="#lspk-modulus"><span class="std std-numref">Fig. 39</span></a>-<a class="reference internal" href="#lspk-phase"><span class="std std-numref">Fig. 40</span></a> and <a class="reference internal" href="#lspk-velocity"><span class="std std-numref">Fig. 41</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">generalToolbox</span> <span class="k">as</span> <span class="nn">gtb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">circuit</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span>

<span class="c1">#%% define components</span>
<span class="n">U</span>   <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Re</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Le</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">inductance</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.2e-3</span><span class="p">)</span>
<span class="n">Bli</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">coupler</span><span class="o">.</span><span class="n">CCVS</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">)</span>
<span class="n">Blv</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">coupler</span><span class="o">.</span><span class="n">CCVS</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.8</span><span class="p">)</span>
<span class="n">Cms</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">capacitance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">1.35e-3</span><span class="p">)</span>
<span class="n">Mms</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">inductance</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">17.9e-3</span><span class="p">)</span>
<span class="n">Rms</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>

<span class="c1">#%% setup and run circuit</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Bli</span><span class="p">,</span> <span class="n">Blv</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% extract and plot results</span>
<span class="n">Ze</span> <span class="o">=</span> <span class="o">-</span> <span class="n">driver</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">driver</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">v</span>  <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">Rms</span><span class="o">.</span><span class="n">Gs</span>
            
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Impedance [Ohm]&quot;</span><span class="p">)</span>
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">Ze</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Impedance [rad]&quot;</span><span class="p">)</span>
<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="n">v</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Velocity [mm/s]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="coupler-spk">
<img alt="_images/coupler_loudspeaker.svg" src="_images/coupler_loudspeaker.svg" />
<figcaption>
<p><span class="caption-number">Fig. 38 </span><span class="caption-text">Lumped network of a loudspeaker driver in free-air.</span><a class="headerlink" href="#coupler-spk" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="lspk-modulus">
<img alt="_images/coupler_loudspeaker_modulus.svg" src="_images/coupler_loudspeaker_modulus.svg" />
<figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">Free-air impedance, modulus.</span><a class="headerlink" href="#lspk-modulus" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="lspk-phase">
<img alt="_images/coupler_loudspeaker_phase.svg" src="_images/coupler_loudspeaker_phase.svg" />
<figcaption>
<p><span class="caption-number">Fig. 40 </span><span class="caption-text">Free-air impedance, phase.</span><a class="headerlink" href="#lspk-phase" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="lspk-velocity">
<img alt="_images/coupler_loudspeaker_velocity.svg" src="_images/coupler_loudspeaker_velocity.svg" />
<figcaption>
<p><span class="caption-number">Fig. 41 </span><span class="caption-text">Free-air velocity.</span><a class="headerlink" href="#lspk-velocity" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="blocks">
<h2>Blocks<a class="headerlink" href="#blocks" title="Link to this heading">#</a></h2>
<p>Blocks regroup components into sub-circuits, allowing complex structures to be condensed into manageable 2- or 4-port modules for easier manipulation.</p>
<section id="id2">
<h3>electric<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>At this stage of development, electric blocks are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.lowpass_butter(A,</span> <span class="pre">B,</span> <span class="pre">order,</span> <span class="pre">fc,</span> <span class="pre">Re)</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.highpass_butter(A,</span> <span class="pre">B,</span> <span class="pre">order,</span> <span class="pre">fc,</span> <span class="pre">Re)</span></code>.</p></li>
</ul>
<p>Both are built using the definitions of Butterworth high- and low-pass filters from <span id="id3">[<a class="reference internal" href="100-ref.html#id3" title="L. Beranek and T. Mellow. Acoustics: Sound Fields, Transducers and Vibration. Elsevier Science, 2019. ISBN 9780128152270. URL: https://books.google.co.uk/books?id=rcopvQEACAAJ.">BM19</a>]</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">generalToolbox</span> <span class="k">as</span> <span class="nn">gtb</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span><span class="p">,</span> <span class="n">csb</span><span class="p">,</span> <span class="n">circuit</span>

<span class="n">frequency</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cir</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>

<span class="c1">#%% Source + crossovers</span>
<span class="n">Vs</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.83</span><span class="p">)</span>
<span class="n">lp1</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">lowpass_butter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">Re</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">hp1</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">highpass_butter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">Re</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1">#%% Electric load</span>
<span class="n">Re8</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">Re4</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1">#%% setup and run </span>
<span class="n">cir</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">lp1</span><span class="p">,</span> <span class="n">hp1</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span> <span class="n">Re8</span><span class="p">,</span> <span class="n">Re4</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% extract FRF</span>
<span class="n">H_lp</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">H_hp</span> <span class="o">=</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="n">cir</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 

<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="p">(</span><span class="n">H_lp</span><span class="p">,</span> <span class="n">H_hp</span><span class="p">,</span> <span class="n">H_lp</span><span class="o">+</span><span class="n">H_hp</span><span class="p">),</span> <span class="s2">&quot;dB&quot;</span><span class="p">,</span>
             <span class="n">legend</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;H_lp&quot;</span><span class="p">,</span> <span class="s2">&quot;H_hp&quot;</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">),</span>
             <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<figure class="align-default" id="block-hplp">
<img alt="_images/block_hp_lp.svg" src="_images/block_hp_lp.svg" />
<figcaption>
<p><span class="caption-number">Fig. 42 </span><span class="caption-text">Frequency-response function of a 3rd order crossover stage.</span><a class="headerlink" href="#block-hplp" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="electrodynamic">
<h3>electrodynamic<a class="headerlink" href="#electrodynamic" title="Link to this heading">#</a></h3>
<p>Electro-dynamic blocks connect electrical to mechanical and/or acoustical domain. For now, only the electro-acoustic driver (EAD) block exists. It essentially regroup the network of <a class="reference internal" href="#coupler-spk"><span class="std std-numref">Fig. 38</span></a> with two additional ports in the acoustical domain: front and back load.</p>
<figure class="align-default" id="block-ead">
<a class="reference internal image-reference" href="_images/EAD_component.svg"><img alt="_images/EAD_component.svg" src="_images/EAD_component.svg" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 43 </span><span class="caption-text"><strong>EAD(A, B, C, D, Le, …, Sd, v_probe:optional)</strong>. Representative 4-port model of the electro-acoustic-driver block. With <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code> being the positive and negative electrical connections; <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code> the front and back acoustic load. If a <em>str</em> (text) is passed to the <code class="docutils literal notranslate"><span class="pre">v_probe</span></code> argument, cone velocity can be extracted using <code class="docutils literal notranslate"><span class="pre">circuit.get_Flow(your_str)</span></code>.</span><a class="headerlink" href="#block-ead" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the next code, we compare different wiring combination of drive units (single speaker, 2-parallel, 2-series). Here, we consider equivalent input power across all three configuration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">generalToolbox</span> <span class="k">as</span> <span class="nn">gtb</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span><span class="p">,</span> <span class="n">csb</span><span class="p">,</span> <span class="n">circuit</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="c1">#%% Initialization of circuits</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">10e3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">single</span>   <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">parallel</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">series</span>   <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>

<span class="c1">#%% driver parameters</span>
<span class="n">Re</span>  <span class="o">=</span> <span class="mi">6</span>
<span class="n">Le</span>  <span class="o">=</span> <span class="mf">0.2e-3</span>
<span class="n">Cms</span> <span class="o">=</span> <span class="mf">1.35e-3</span>
<span class="n">Mms</span> <span class="o">=</span> <span class="mf">17.9e-3</span>
<span class="n">Rms</span> <span class="o">=</span> <span class="mf">0.9</span>
<span class="n">Bl</span>  <span class="o">=</span> <span class="mf">7.8</span>
<span class="n">Sd</span>  <span class="o">=</span> <span class="mf">158e-4</span>

<span class="c1">#%% Estimate input voltage to get 1W of power</span>
<span class="n">U_single</span>   <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Re</span><span class="p">)</span>
<span class="n">U_parallel</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Re</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">U_series</span>   <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Re</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#%% 1. single driver</span>
<span class="n">Vs</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">U_single</span><span class="p">)</span>
<span class="n">ead_1</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EAD</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">Sd</span><span class="p">,</span> <span class="n">v_probe</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
<span class="n">rad_1</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">single</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">ead_1</span><span class="p">)</span>
<span class="n">single</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span> <span class="n">rad_1</span><span class="p">)</span>

<span class="c1">#%% 2. parallel drivers</span>
<span class="n">Vs</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">U_parallel</span><span class="p">)</span>
<span class="n">ead_1</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EAD</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">Sd</span><span class="p">,</span> <span class="n">v_probe</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
<span class="n">rad_1</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">ead_2</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EAD</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">rad_2</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">ead_1</span><span class="p">,</span> <span class="n">ead_2</span><span class="p">)</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span> <span class="n">rad_1</span><span class="p">,</span> <span class="n">rad_2</span><span class="p">)</span>

<span class="c1">#%% 3. Series drivers</span>
<span class="n">Vs</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">U_series</span><span class="p">)</span>
<span class="n">ead_1</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EAD</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">Sd</span><span class="p">,</span> <span class="n">v_probe</span><span class="o">=</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>
<span class="n">rad_1</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">ead_2</span> <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EAD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Le</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">Cms</span><span class="p">,</span> <span class="n">Mms</span><span class="p">,</span> <span class="n">Rms</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">rad_2</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Sd</span><span class="p">)</span>
<span class="n">series</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">ead_1</span><span class="p">,</span> <span class="n">ead_2</span><span class="p">)</span>
<span class="n">series</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span> <span class="n">rad_1</span><span class="p">,</span> <span class="n">rad_2</span><span class="p">)</span>

<span class="c1">#%% run simulations</span>
<span class="n">single</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">parallel</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">series</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% plot driver velocities</span>
<span class="n">Z_single</span>   <span class="o">=</span> <span class="o">-</span><span class="n">single</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">single</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Z_parallel</span> <span class="o">=</span> <span class="o">-</span><span class="n">parallel</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">parallel</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Z_series</span>   <span class="o">=</span> <span class="o">-</span><span class="n">series</span><span class="o">.</span><span class="n">getPotential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">series</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">v_single</span>   <span class="o">=</span> <span class="n">single</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>   <span class="o">*</span> <span class="mf">1e3</span>   
<span class="n">v_parallel</span> <span class="o">=</span> <span class="n">parallel</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e3</span>
<span class="n">v_series</span>   <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">getFlow</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span>   <span class="o">*</span> <span class="mf">1e3</span>

<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="p">(</span><span class="n">Z_single</span><span class="p">,</span> <span class="n">Z_parallel</span><span class="p">,</span> <span class="n">Z_series</span><span class="p">),</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span>
             <span class="n">legend</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;parallel&quot;</span><span class="p">,</span> <span class="s2">&quot;series&quot;</span><span class="p">),</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Impedance [Ohm]&quot;</span><span class="p">)</span>

<span class="n">gtb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">FRF</span><span class="p">(</span><span class="n">frequency</span><span class="p">,</span> <span class="p">(</span><span class="n">v_single</span><span class="p">,</span> <span class="n">v_parallel</span><span class="p">,</span> <span class="n">v_series</span><span class="p">),</span> <span class="s2">&quot;abs&quot;</span><span class="p">,</span>
             <span class="n">legend</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;single&quot;</span><span class="p">,</span> <span class="s2">&quot;parallel&quot;</span><span class="p">,</span> <span class="s2">&quot;series&quot;</span><span class="p">),</span>
             <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Velocity [mm/s]&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="ead-impedance">
<img alt="_images/impedance_comparison.svg" src="_images/impedance_comparison.svg" />
<figcaption>
<p><span class="caption-number">Fig. 44 </span><span class="caption-text">Impedance comparison between single, parallel and series configuration.</span><a class="headerlink" href="#ead-impedance" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="ead-velocity">
<img alt="_images/velocity_comparison.svg" src="_images/velocity_comparison.svg" />
<figcaption>
<p><span class="caption-number">Fig. 45 </span><span class="caption-text">Velocity comparison between single, parallel and series configuration.</span><a class="headerlink" href="#ead-velocity" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="application-example">
<span id="chapter-monitorcrossover"></span><h2>Application example<a class="headerlink" href="#application-example" title="Link to this heading">#</a></h2>
<p>Here we take the studio monitor from the <strong><a class="reference internal" href="02-loudspeaker_system.html#loudspeakersystem"><span class="std std-ref">Loudspeaker System</span></a></strong> part, and re-create the passive crossover done in VituixCAD. Both electric and acoustic domain are modeled, the coupling handled with <code class="docutils literal notranslate"><span class="pre">EAD</span></code> blocks, as explained above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">generalToolbox</span> <span class="k">as</span> <span class="nn">gtb</span>
<span class="kn">import</span> <span class="nn">electroacPy</span> <span class="k">as</span> <span class="nn">ep</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">csc</span><span class="p">,</span> <span class="n">csb</span>
<span class="kn">from</span> <span class="nn">electroacPy</span> <span class="kn">import</span> <span class="n">circuit</span>

<span class="c1">#%% initialize component to avoid long declarations</span>
<span class="n">inductance</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">inductance</span>
<span class="n">resistance</span>  <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">resistance</span>
<span class="n">capacitance</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">capacitance</span>
<span class="n">EAD</span>         <span class="o">=</span> <span class="n">csb</span><span class="o">.</span><span class="n">electrodynamic</span><span class="o">.</span><span class="n">EADFromFile</span>
<span class="n">cavity</span>      <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">cavity</span>
<span class="n">port</span>        <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">port</span>
<span class="n">radiator</span>    <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">acoustic</span><span class="o">.</span><span class="n">radiator</span>

<span class="c1">#%% load radiation data (without post-processing)</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;06_acoustic_radiation_refined&quot;</span><span class="p">)</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">frequency</span>

<span class="c1">#%% get LPM data</span>
<span class="n">lpm_woofer</span>   <span class="o">=</span> <span class="s2">&quot;../technical_data/SB SB34NRXL75-8.txt&quot;</span>
<span class="n">lpm_midrange</span> <span class="o">=</span> <span class="s2">&quot;../technical_data/SB MR16PNW-8.txt&quot;</span>
<span class="n">lpm_tweeter</span>  <span class="o">=</span> <span class="s2">&quot;../technical_data/TW29RN-B.txt&quot;</span>

<span class="c1">#%% create circuit from VituixCAD network</span>
<span class="n">sV</span> <span class="o">=</span> <span class="n">csc</span><span class="o">.</span><span class="n">electric</span><span class="o">.</span><span class="n">voltageSource</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.83</span><span class="p">)</span>

<span class="c1"># LF filter</span>
<span class="n">L1</span> <span class="o">=</span> <span class="n">inductance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.3e-3</span><span class="p">)</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">33e-6</span><span class="p">)</span>
<span class="n">R1</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">)</span>

<span class="c1"># LF driver + acoustic</span>
<span class="n">LF</span>      <span class="o">=</span> <span class="n">EAD</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="n">lpm_woofer</span><span class="p">,</span> <span class="s2">&quot;v_lf&quot;</span><span class="p">)</span>
<span class="n">rad_lf</span>  <span class="o">=</span> <span class="n">radiator</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">LF</span><span class="o">.</span><span class="n">Sd</span><span class="p">)</span>
<span class="n">box_lf</span>  <span class="o">=</span> <span class="n">cavity</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">40e-3</span><span class="p">)</span>
<span class="n">prt</span>     <span class="o">=</span> <span class="n">port</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">35e-2</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)</span>
<span class="n">rad_prt</span> <span class="o">=</span> <span class="n">radiator</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="mf">5e-2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># MF filter</span>
<span class="n">C2</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">43e-6</span><span class="p">)</span>
<span class="n">L2</span> <span class="o">=</span> <span class="n">inductance</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">560e-6</span><span class="p">)</span>
<span class="n">L3</span> <span class="o">=</span> <span class="n">inductance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">6.6e-3</span><span class="p">)</span>
<span class="n">C3</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.66e-6</span><span class="p">)</span>
<span class="n">L4</span> <span class="o">=</span> <span class="n">inductance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">6.8e-3</span><span class="p">)</span>
<span class="n">C4</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">390e-6</span><span class="p">)</span>
<span class="n">R2</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.6</span><span class="p">)</span>
<span class="n">C5</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">3.3e-6</span><span class="p">)</span>
<span class="n">R3</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">)</span>
<span class="n">R4</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">)</span>
<span class="n">R5</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>

<span class="c1"># MF driver + acoustic</span>
<span class="n">MF</span>     <span class="o">=</span> <span class="n">EAD</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">lpm_midrange</span><span class="p">,</span> <span class="s2">&quot;v_mf&quot;</span><span class="p">)</span>
<span class="n">rad_mf</span> <span class="o">=</span> <span class="n">radiator</span><span class="p">(</span><span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">MF</span><span class="o">.</span><span class="n">Sd</span><span class="p">)</span>
<span class="n">box_mf</span> <span class="o">=</span> <span class="n">cavity</span><span class="p">(</span><span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">5.1e-3</span><span class="p">)</span>

<span class="c1"># HF filter</span>
<span class="n">C6</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">14.4e-6</span><span class="p">)</span>
<span class="n">C7</span> <span class="o">=</span> <span class="n">capacitance</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mf">126e-6</span><span class="p">)</span>
<span class="n">L5</span> <span class="o">=</span> <span class="n">inductance</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mf">0.4e-3</span><span class="p">)</span>
<span class="n">R6</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">)</span>
<span class="n">R7</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">R8</span> <span class="o">=</span> <span class="n">resistance</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">11.5</span><span class="p">)</span>

<span class="c1"># HF driver + acoustic</span>
<span class="n">HF</span> <span class="o">=</span> <span class="n">EAD</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">lpm_tweeter</span><span class="p">,</span> <span class="s2">&quot;v_hf&quot;</span><span class="p">)</span>
<span class="n">rad_hf</span> <span class="o">=</span> <span class="n">radiator</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">HF</span><span class="o">.</span><span class="n">Sd</span><span class="p">)</span>

<span class="c1">#%% Assemble circuit</span>
<span class="c1"># frequency = gtb.freqop.freq_log10(10, 10e3, 125)</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">addComponent</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">L3</span><span class="p">,</span> <span class="n">L4</span><span class="p">,</span> <span class="n">L5</span><span class="p">,</span> 
                     <span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">C5</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C7</span><span class="p">,</span>
                     <span class="n">R1</span><span class="p">,</span> <span class="n">R2</span><span class="p">,</span> <span class="n">R3</span><span class="p">,</span> <span class="n">R4</span><span class="p">,</span> <span class="n">R5</span><span class="p">,</span> <span class="n">R6</span><span class="p">,</span> <span class="n">R7</span><span class="p">,</span> <span class="n">R8</span><span class="p">,</span> 
                     <span class="n">sV</span><span class="p">,</span>
                     <span class="n">rad_lf</span><span class="p">,</span> <span class="n">box_lf</span><span class="p">,</span> <span class="n">prt</span><span class="p">,</span> <span class="n">rad_prt</span><span class="p">,</span>
                     <span class="n">rad_mf</span><span class="p">,</span> <span class="n">box_mf</span><span class="p">,</span>
                     <span class="n">rad_hf</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">addBlock</span><span class="p">(</span><span class="n">LF</span><span class="p">,</span> <span class="n">MF</span><span class="p">,</span> <span class="n">HF</span><span class="p">)</span>
<span class="n">network</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1">#%% add transfer functions to network</span>
<span class="n">system</span><span class="o">.</span><span class="n">filter_network</span><span class="p">(</span><span class="s2">&quot;LF_xover&quot;</span><span class="p">,</span> <span class="n">ref2bem</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ref2study</span><span class="o">=</span><span class="s2">&quot;free-field&quot;</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">filter_addTransferFunction</span><span class="p">(</span><span class="s2">&quot;LF_xover&quot;</span><span class="p">,</span> <span class="s2">&quot;hlf&quot;</span><span class="p">,</span> <span class="n">H_lf</span><span class="p">)</span>

<span class="n">system</span><span class="o">.</span><span class="n">filter_network</span><span class="p">(</span><span class="s2">&quot;MF_xover&quot;</span><span class="p">,</span> <span class="n">ref2bem</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ref2study</span><span class="o">=</span><span class="s2">&quot;free-field&quot;</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">filter_addTransferFunction</span><span class="p">(</span><span class="s2">&quot;MF_xover&quot;</span><span class="p">,</span> <span class="s2">&quot;hmf&quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">H_mf</span><span class="p">)</span>  <span class="c1"># &quot;-&quot; to reverse phase </span>

<span class="n">system</span><span class="o">.</span><span class="n">filter_network</span><span class="p">(</span><span class="s2">&quot;HF_xover&quot;</span><span class="p">,</span> <span class="n">ref2bem</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref2study</span><span class="o">=</span><span class="s2">&quot;free-field&quot;</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">filter_addTransferFunction</span><span class="p">(</span><span class="s2">&quot;HF_xover&quot;</span><span class="p">,</span> <span class="s2">&quot;hhf&quot;</span><span class="p">,</span> <span class="n">H_hf</span><span class="p">)</span>
</pre></div>
</div>
<p>This code gives horizontal and vertical directivity responses as seen in <a class="reference internal" href="#xover-rad-polar-hor"><span class="std std-numref">Fig. 46</span></a> and <a class="reference internal" href="#xover-rad-polar-ver"><span class="std std-numref">Fig. 47</span></a>. The transfer functions of the crossover network is shown in <a class="reference internal" href="#xover-tf"><span class="std std-numref">Fig. 48</span></a></p>
<figure class="align-default" id="xover-rad-polar-hor">
<img alt="_images/monitor_passive_xover_rad_b.svg" src="_images/monitor_passive_xover_rad_b.svg" />
<figcaption>
<p><span class="caption-number">Fig. 46 </span><span class="caption-text">Horizontal directivity with passive crossovers.</span><a class="headerlink" href="#xover-rad-polar-hor" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="xover-rad-polar-ver">
<img alt="_images/monitor_passive_xover_rad.svg" src="_images/monitor_passive_xover_rad.svg" />
<figcaption>
<p><span class="caption-number">Fig. 47 </span><span class="caption-text">Vertical directivity with passive crossovers.</span><a class="headerlink" href="#xover-rad-polar-ver" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="xover-tf">
<img alt="_images/xover_transfer_functions.svg" src="_images/xover_transfer_functions.svg" />
<figcaption>
<p><span class="caption-number">Fig. 48 </span><span class="caption-text">Lowpass, bandpass, highpass and total response of the passive filter network.</span><a class="headerlink" href="#xover-tf" title="Link to this image">#</a></p>
</figcaption>
</figure>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="acoustic-analogies" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>These are: acoustic mass, compliance, and loss.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="06-back_end.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Back-end</p>
      </div>
    </a>
    <a class="right-next"
       href="08-LEM_backend.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">LEM modules</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electric">electric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acoustic">acoustic</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coupler-controlled-sources">Coupler / Controlled sources</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#blocks">Blocks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">electric</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrodynamic">electrodynamic</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-example">Application example</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tom Munoz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>